diff --git a/CMakeLists.txt b/CMakeLists.txt
index 8e398785..0789e59d 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -53,11 +53,7 @@ project(faiss
   LANGUAGES ${FAISS_LANGUAGES})
 include(GNUInstallDirs)

-if(FAISS_ENABLE_CUVS)
-  set(CMAKE_CXX_STANDARD 17)
-else()
-  set(CMAKE_CXX_STANDARD 20)
-endif()
+set(CMAKE_CXX_STANDARD 20)

 list(APPEND CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/cmake")

diff --git a/faiss/gpu/impl/CuvsIVFPQ.cu b/faiss/gpu/impl/CuvsIVFPQ.cu
index 1e2fef22..f2f29302 100644
--- a/faiss/gpu/impl/CuvsIVFPQ.cu
+++ b/faiss/gpu/impl/CuvsIVFPQ.cu
@@ -129,8 +129,14 @@ void CuvsIVFPQ::updateQuantizer(Index* quantizer) {

     cuvs::neighbors::ivf_pq::helpers::reset_index(
             raft_handle, cuvs_index.get());
+    auto mutable_rotation_matrix_view =
+            raft::make_device_matrix_view<float, uint32_t>(
+                    const_cast<float*>(
+                            cuvs_index->rotation_matrix().data_handle()),
+                    cuvs_index->rotation_matrix().extent(0),
+                    cuvs_index->rotation_matrix().extent(1));
     cuvs::neighbors::ivf_pq::helpers::make_rotation_matrix(
-            raft_handle, cuvs_index.get(), false);
+            raft_handle, mutable_rotation_matrix_view, false);

     // If the index instance is a GpuIndexFlat, then we can use direct access to
     // the centroids within.
@@ -149,22 +155,60 @@ void CuvsIVFPQ::updateQuantizer(Index* quantizer) {
             // as float32 and store locally
             gpuData->reconstruct(0, gpuData->getSize(), centroids);

-            cuvs::neighbors::ivf_pq::helpers::set_centers(
-                    raft_handle,
-                    cuvs_index.get(),
+            auto mutable_centers_view =
+                    raft::make_device_matrix_view<float, uint32_t>(
+                            const_cast<float*>(
+                                    cuvs_index->centers().data_handle()),
+                            numLists_,
+                            cuvs_index->centers().extent(1));
+            auto mutable_centers_rot_view =
                     raft::make_device_matrix_view<float, uint32_t>(
-                            centroids.data(), numLists_, dim_));
+                            const_cast<float*>(
+                                    cuvs_index->centers_rot().data_handle()),
+                            cuvs_index->centers_rot().extent(0),
+                            cuvs_index->centers_rot().extent(1));
+
+            cuvs::neighbors::ivf_pq::helpers::pad_centers_with_norms(
+                    raft_handle,
+                    raft::make_const_mdspan(
+                            raft::make_device_matrix_view<float, uint32_t>(
+                                    centroids.data(), numLists_, dim_)),
+                    mutable_centers_view);
+            cuvs::neighbors::ivf_pq::helpers::rotate_padded_centers(
+                    raft_handle,
+                    cuvs_index->centers(),
+                    cuvs_index->rotation_matrix(),
+                    mutable_centers_rot_view);
         } else {
             /// No reconstruct needed since the centers are already in float32
             // The FlatIndex keeps its data in float32, so we can merely
             // reference it
             auto centroids = gpuData->getVectorsFloat32Ref();

-            cuvs::neighbors::ivf_pq::helpers::set_centers(
-                    raft_handle,
-                    cuvs_index.get(),
+            auto mutable_centers_view =
+                    raft::make_device_matrix_view<float, uint32_t>(
+                            const_cast<float*>(
+                                    cuvs_index->centers().data_handle()),
+                            numLists_,
+                            cuvs_index->centers().extent(1));
+            auto mutable_centers_rot_view =
                     raft::make_device_matrix_view<float, uint32_t>(
-                            centroids.data(), numLists_, dim_));
+                            const_cast<float*>(
+                                    cuvs_index->centers_rot().data_handle()),
+                            cuvs_index->centers_rot().extent(0),
+                            cuvs_index->centers_rot().extent(1));
+
+            cuvs::neighbors::ivf_pq::helpers::pad_centers_with_norms(
+                    raft_handle,
+                    raft::make_const_mdspan(
+                            raft::make_device_matrix_view<float, uint32_t>(
+                                    centroids.data(), numLists_, dim_)),
+                    mutable_centers_view);
+            cuvs::neighbors::ivf_pq::helpers::rotate_padded_centers(
+                    raft_handle,
+                    cuvs_index->centers(),
+                    cuvs_index->rotation_matrix(),
+                    mutable_centers_rot_view);
         }
     } else {
         DeviceTensor<float, 2, true> centroids(
@@ -180,11 +224,30 @@ void CuvsIVFPQ::updateQuantizer(Index* quantizer) {

         centroids.copyFrom(vecs, stream);

-        cuvs::neighbors::ivf_pq::helpers::set_centers(
-                raft_handle,
-                cuvs_index.get(),
+        // Create mutable views for output parameters
+        auto mutable_centers_view =
+                raft::make_device_matrix_view<float, uint32_t>(
+                        const_cast<float*>(cuvs_index->centers().data_handle()),
+                        numLists_,
+                        cuvs_index->centers().extent(1));
+        auto mutable_centers_rot_view =
                 raft::make_device_matrix_view<float, uint32_t>(
-                        centroids.data(), numLists_, dim_));
+                        const_cast<float*>(
+                                cuvs_index->centers_rot().data_handle()),
+                        cuvs_index->centers_rot().extent(0),
+                        cuvs_index->centers_rot().extent(1));
+
+        cuvs::neighbors::ivf_pq::helpers::pad_centers_with_norms(
+                raft_handle,
+                raft::make_const_mdspan(
+                        raft::make_device_matrix_view<float, uint32_t>(
+                                centroids.data(), numLists_, dim_)),
+                mutable_centers_view);
+        cuvs::neighbors::ivf_pq::helpers::rotate_padded_centers(
+                raft_handle,
+                cuvs_index->centers(),
+                cuvs_index->rotation_matrix(),
+                mutable_centers_rot_view);
     }

     setPQCentroids_();
@@ -404,10 +467,11 @@ void CuvsIVFPQ::copyInvertedListsFrom(const InvertedLists* ivf) {
     auto& cuvs_index_lists = cuvs_index->lists();

     // conservative memory alloc for cloning cpu inverted lists
-    cuvs::neighbors::ivf_pq::list_spec<uint32_t, idx_t> ivf_list_spec{
-            static_cast<uint32_t>(bitsPerSubQuantizer_),
-            static_cast<uint32_t>(numSubQuantizers_),
-            true};
+    cuvs::neighbors::ivf_pq::list_spec_interleaved<uint32_t, idx_t>
+            ivf_list_spec{
+                    static_cast<uint32_t>(bitsPerSubQuantizer_),
+                    static_cast<uint32_t>(numSubQuantizers_),
+                    true};

     for (size_t i = 0; i < nlist; ++i) {
         size_t listSize = ivf->list_size(i);
@@ -426,7 +490,7 @@ void CuvsIVFPQ::copyInvertedListsFrom(const InvertedLists* ivf) {
         // This cuVS list must currently be empty
         FAISS_ASSERT(getListLength(i) == 0);

-        cuvs::neighbors::ivf::resize_list(
+        cuvs::neighbors::ivf_pq::helpers::resize_list(
                 raft_handle,
                 cuvs_index_lists[i],
                 ivf_list_spec,
@@ -520,7 +584,7 @@ void CuvsIVFPQ::setPQCentroids_() {
     auto stream = resources_->getDefaultStreamCurrentDevice();

     raft::copy(
-            cuvs_index->pq_centers().data_handle(),
+            const_cast<float*>(cuvs_index->pq_centers().data_handle()),
             pqCentroidsInnermostCode_.data(),
             pqCentroidsInnermostCode_.numElements(),
             stream);
