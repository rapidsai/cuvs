/*
 * SPDX-FileCopyrightText: Copyright (c) @year@, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
 * SPDX-License-Identifier: Apache-2.0
 */

// This file is auto-generated. Do not edit manually.

#ifdef BUILD_KERNEL

#include <neighbors/ivf_flat/jit_lto_kernels/ivf_flat_interleaved_scan_kernel.cuh>

namespace cuvs::neighbors::ivf_flat::detail {

// Instantiate the kernel template
// Pass individual filter parameters like CAGRA does
template __global__ void interleaved_scan_kernel<@capacity@, @veclen@, @ascending@, @compute_norm@, @data_type@, @acc_type@, @idx_type@>(
    const uint32_t, const @data_type@*, const uint32_t*, const @data_type@* const*, const uint32_t*,
    const uint32_t, const uint32_t, const uint32_t, const uint32_t, const uint32_t*, const uint32_t,
    @idx_type@* const* const, uint32_t*, @idx_type@, @idx_type@, uint32_t*, float*);

}  // namespace cuvs::neighbors::ivf_flat::detail

#else

#include <cuvs/detail/jit_lto/RegisterKernelFragment.hpp>
#include <cuvs/detail/jit_lto/registration_tags.hpp>
#include "interleaved_scan_kernel_@capacity@_@veclen@_@ascending@_@compute_norm@_@type_abbrev@_@acc_abbrev@_@idx_abbrev@.h"

using namespace cuvs::neighbors::ivf_flat::detail;

__attribute__((__constructor__)) static void register_kernel_@capacity@_@veclen@_@ascending@_@compute_norm@_@type_abbrev@_@acc_abbrev@_@idx_abbrev@()
{
  registerAlgorithm<tag_@type_abbrev@,
    tag_acc_@acc_abbrev@,
    tag_idx_@idx_abbrev@>(
    "interleaved_scan_kernel_@capacity@_@veclen@_@ascending@_@compute_norm@",
    embedded_interleaved_scan_kernel_@capacity@_@veclen@_@ascending@_@compute_norm@_@type_abbrev@_@acc_abbrev@_@idx_abbrev@,
    sizeof(embedded_interleaved_scan_kernel_@capacity@_@veclen@_@ascending@_@compute_norm@_@type_abbrev@_@acc_abbrev@_@idx_abbrev@));
}

#endif
