/*
 * SPDX-FileCopyrightText: Copyright (c) @year@, NVIDIA CORPORATION.
 * SPDX-License-Identifier: Apache-2.0
 */

// This file is auto-generated. Do not edit manually.

#ifdef BUILD_KERNEL

#include <neighbors/detail/cagra/jit_lto_kernels/setup_workspace_vpq_impl_unified.cuh>

namespace cuvs::neighbors::cagra::detail {

// Instantiate the unified setup_workspace function for VPQ descriptor
// PQ_BITS>0, PQ_LEN>0, CodebookT=half for VPQ descriptors
template __device__ cuvs::neighbors::cagra::detail::dataset_descriptor_base_t<@data_type@, @index_type@, @distance_type@>* setup_workspace<@team_size@, @dataset_block_dim@, @pq_bits@, @pq_len@, @codebook_type@, @data_type@, @index_type@, @distance_type@>(
    cuvs::neighbors::cagra::detail::dataset_descriptor_base_t<@data_type@, @index_type@, @distance_type@>*, void*, const @data_type@*, uint32_t);

}  // namespace cuvs::neighbors::cagra::detail

#else

#include <cuvs/detail/jit_lto/RegisterKernelFragment.hpp>
#include <cuvs/detail/jit_lto/cagra/search_single_cta_tags.hpp>
#include "setup_workspace_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@.h"

using namespace cuvs::neighbors::cagra::detail;

__attribute__((__constructor__)) static void register_setup_workspace_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@()
{
  // This fragment provides setup_workspace (VPQ version)
  // The planner links the appropriate fragment (standard or VPQ) based on descriptor type
  registerAlgorithm<tag_@type_abbrev@,
    tag_idx_@idx_abbrev@,
    tag_dist_@dist_abbrev@,
    tag_codebook_half>(
    "setup_workspace_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd",
    embedded_setup_workspace_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@,
    sizeof(embedded_setup_workspace_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@));
}

#endif
