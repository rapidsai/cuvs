/*
 * SPDX-FileCopyrightText: Copyright (c) @year@, NVIDIA CORPORATION.
 * SPDX-License-Identifier: Apache-2.0
 */

// This file is auto-generated. Do not edit manually.

#ifdef BUILD_KERNEL

#include <neighbors/detail/cagra/jit_lto_kernels/search_multi_kernel_jit.cuh>
#include <neighbors/detail/cagra/compute_distance_vpq-impl.cuh>

namespace cuvs::neighbors::cagra::detail::multi_kernel_search {

// Instantiate the compute_distance_to_child_nodes_kernel_jit function with concrete VPQ descriptor type
// Note: Metric is no longer a template parameter - VPQ only supports L2Expanded
using desc_t = cuvs::neighbors::cagra::detail::cagra_q_dataset_descriptor_t<@team_size@, @dataset_block_dim@, @pq_bits@, @pq_len@, @codebook_type@, @data_type@, @index_type@, @distance_type@>;
template __global__ void compute_distance_to_child_nodes_kernel_jit<desc_t, @source_index_type@, cuvs::neighbors::filtering::none_sample_filter>(
    const @index_type@* const, @index_type@* const, @distance_type@* const, const std::size_t, const std::uint32_t, const desc_t*, const @index_type@* const, const std::uint32_t, const @source_index_type@*, const @data_type@*, @index_type@* const, const std::uint32_t, @index_type@* const, @distance_type@* const, const std::uint32_t, cuvs::neighbors::filtering::none_sample_filter);

}  // namespace cuvs::neighbors::cagra::detail::multi_kernel_search

#else

#include <cuvs/detail/jit_lto/RegisterKernelFragment.hpp>
#include <cuvs/detail/jit_lto/cagra/search_single_cta_tags.hpp>
#include "compute_distance_to_child_nodes_kernel_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@_@src_idx_abbrev@.h"

using namespace cuvs::neighbors::cagra::detail;

__attribute__((__constructor__)) static void register_compute_distance_to_child_nodes_kernel_vpq_@type_abbrev@_@idx_abbrev@_@dist_abbrev@_@src_idx_abbrev@()
{
  registerAlgorithm<tag_@type_abbrev@,
    tag_idx_@idx_abbrev@,
    tag_dist_@dist_abbrev@,
    tag_idx_@src_idx_abbrev@,
    tag_codebook_half>(
    "compute_distance_to_child_nodes_kernel_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd",
    embedded_compute_distance_to_child_nodes_kernel_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@_@src_idx_abbrev@,
    sizeof(embedded_compute_distance_to_child_nodes_kernel_vpq_t@team_size@_dim@dataset_block_dim@_@pq_bits@pq_@pq_len@subd_@type_abbrev@_@idx_abbrev@_@dist_abbrev@_@src_idx_abbrev@));
}

#endif
